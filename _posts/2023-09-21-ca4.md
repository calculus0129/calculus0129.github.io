---
title: \[CA4\]
header: header
toc: true
toc_sticky: true
toc_label: "Contents"
excerpt: 
date: 2023-09-21
categories:
    - computerarchitecture
tags:
  - languages:Korean
  - languages:English
---

<style>
    a.links {
        font-size: 4px;
    }
    span.cf {
        background-color: #fef;
    }
    span.imp {
        color: #f00;
        font-style: bold;
    }
    span.highlight {
        background-color: #ff0;
    }
    div.cf {
        background-color: #fef;
    }
    span.red {
        color: #f00;
    }
    span.green {
        color: #0f0;
    }
    span.blue {
        color: #00f;
    }
</style>

<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>


### 4.1. Introduction

Performance of a computer:
- instruction count (determined by the ISA and the compiler.)
- clock cycle time
- clock cycles per instruction (CPI).

**Implementation** of **the processor** determines both **the clock cycle time** and the number of **CPI**.

Construct the datapath and control unit for two different implementations of the MIPS instruction set.
- A simplified version
- A more realistic pipelined version.

'key question' in creating a **datapath** and designing the **control**: Examine implementations of...
- Memory reference instructions: lw, sw
- Arithmetic-logical instructions: add, sub, AND, OR, and slt
- Control transfer: beq, j

### 4.2. Logic Design Conventions

terms

- combinational & sequential element: Nyum.
- clocking methodology: The approach used to determine when data is valid and stable relative to the clock.
- edge-triggered clocking: A clocking scheme in which all state changes occur on a clock edge.
- control signal: A signal used for multiplexor slection or for directing the operation of a functional unit; contrasts with a data signal, which contains information that is operated on by a functional unit.
- asserted / deasserted : The signal is logically high or true / low or false.

#### from Appendix B.

##### B.2. Gates, Truth Tables, and Logical Equations

- asserted signal: A signal that is logically true, or 1.
- deasserted signal: A signal that is (logically) false, or 0.
- combinational logic: A logic system whose blocks do not contain memory and hence comput the same output given the same input.
- sequential logic: A group of logic elements that **contain memory** and hence whose value depends on the **inputs as well as the currnt contents of the memory**.
- gate: A device that implements basic logic functions, such as AND or OR.
  e.g. NOR gate, NAND gate.

##### B.3. Combinational Logic

- decoder: A logic block that has an n-bit input and $$2^{n}$$ outputs, where *only one output* is asserted for each input combination.
  e.g. 3-to-8 decoder, 5-to-32 decoder.
- multiplexor: A logic element that chooses from among the multiple sources and steers one of those sources to its destination. (combinational!)
- selector value (=**control value**): The control signal that is used to select one of the input values of a multiplexor as the output of the multiplexor.

#### Logic Design Basics

- Information encoded in binary.
  - Low voltage = 0, High Voltage = 1
  - One wire per bit.
  - Multi-bit data encoded on multi-wire buses.
- combinational element
  : An operational element. (Output doesn't depend on memory, but only on its inputs)<br>
  e.g. multiplexor, AND, OR, ALU
- State(sequential) element
  : A memory element (output depends on both internal state(memory) and inputs)<br>
  e.g. register, memory

#### Combinational Elements

![Combinational Element Figure](/images/ca4_comb-elements.png)<br>
\(S: signal/controller\)

#### Clocking Methodology

See the slides and paste it if you want.

### 4.3. Building a Datapath

terms:

- datapath element
- register file
- sign-extend
- branch target address
- branch taken
- branch not taken (or untaken branch)
- delayed branch

### 4.4. A Simple Implementation Scheme

terms

- truth table: From logic, a representation of a logical operation by listing all the values of the inputs and then in each case showing what the resulting outputs should be.
- don't-care term: An element of a logical function in which the output does not depend on the values of all the inputs. Don't-care terms may be specified in different ways.
- opcode: The field that denotes the operation and format of an instruction.
- single-(/single clock) cycle implementation: An implementation in which all instructions are executed in one clock cycle. While easy to understand, it is too slow to be practical.

Clock blarg

### 4.5. A Multicycle Implementation (Later)

multicycle implementation?

### 4.6. An Overview of Pipelining

terms

- pipelining: An implementation technique in which multiple instructions are overlapped in execution, much like an assembly line.
- structural hazard: When a planned instruction **cannot execute in the proper clock cycle** because the hardware **does not support the combination of instructions** that are set to execute.
- data hazard (= pipline data hazard): When a planned instruction cannot excute in the proper clock cycle because **data** that is **needed to execute the instruction** is **not yet available**.
- forwarding (= bypassing): A method of resolving a data hazard by retrieving the missing data element from internal buffers rather than waiting for it to arrive from programmer-visible registers or memory.
- load-use data hazard: A specific form of data hazard in which th data being loaded by a load instrcution has not yet become available when it is neded by anothr instruction
- pipeline stall(=bubble): A stall initiated in order to resolve a hazard.
- control hazard (= branch hazard): When the proper instruction cannot execute in the proper pipeline clock cycle because the instruction that was fetched is not the one that is needed; that is, the **flow of instruction addresses** is not what the pipeline expected.
- branch prediction: A method of resolving a branch hazard that assumes a given outcome for the branch and proceeds from that assumption rather than waiting to ascertain th actual outcome.

### 4.7. Pipelined Datapath and Control

terms:

- latency (pipeline): The number of stages in a pipeline or the number of stages between two instructions during execution.

5 Steps:

1. IF : Instruction fetch from memory
2. ID : Instruction decode & register read
3. EX : Execute operation or calculate address
4. MEM : Access memory operand
5. WB : Write result back to register

| Instr | IF | ID | ALU op | Mem | RegWrite(WB) | Total Time |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| lw | 200 | 100 | 200 | 200 | 100 | 800 |
| sw | 200 | 100 | 200 | 200 |  | 700 |
| R-format | 200 | 100 | 200 | 200 | 100 | 800 |
| lw | 200 | 100 | 200 | 200 | 100 | 800 |

When does the Multi-cycle datapath performs better than 

benefit : one instruction involves many "stages". (e.g. 30 stages => better performance.)

In this case, beneficial.

e.g. Single-cycle : T_c = 800ps, Pipelined => T_c = 200ps

speedup for n instructions

$$ nyum $$

Imbalanced time consumption of execution => 

spedup = throughput (*2, not *5).


(4.5. : need additional register in PP)

### 4.8. Data Hazards: Forwarding versus Stalling

terms:

- nop: An instruction that does no operation to change state.

### 4.9. Control Hazards

terms:

- flush: To discard instructions in a pipeline, usually due to an unexpected event.
- dynamic branch prediction: Prediction of branches at runtime using runtime information.
- branch prediction (= branch history table): A small memory that is indexed by the lower portion of the address of the branch instruction and that contains one or more bits indicating whether the branch was recently taken or not.
- branch delay slot?: The slot directly after a delayed branch instruction, which in the MIPS architecture is filled by an instruction that does not affect the branch.

- branch target buffer: A structure that caches the destination PC or destination instruction for a branch. It is usually organized as a cache with tags, making it more costly than a simple prediction buffer.
- correlating predictor: A branch predictor that combines local behavior of a particular branch and global information about the behavior of some recent number of executed branches.
- tournament branch predictor: A branch predictor with multiple predictions for each branch and a selection mechanism that chooses which predictor to enable for a given branch.

### 4.10. Exceptions

terms:

- exception (= interrupt): An unscheduled event that disrupts program execution; used to detect overflow.
- interrupt: An exception that comes from **outside** of the **processor**. (*Some architectures* use the term interrupt for *all* exceptions.)
- vectored interrupt: An interrupt for which the **address** to which control is **transferred** is determined by the **cause** of the exception.
- imprecise interrupt (=imprecise exception): Interrupts or exceptions in *pipelined computers* that are **not associated** with the **exact instruction** that was the **cause** of the interrupt or exception.
- precise interrupt/exception: An interrupt or exception that is always associated with the correct instruction in pipelined computers.

### 4.11 Parallelism via Instructions

terms:

- instruction-level parallelism: The parallelism among instructions.
- multiple issue: A scheme whereby **multiple instructions** are launched in **one clock cycle**.
- static multiple issue: An approach to implementing a multiple-issue processor where many **decisions** are made by the **compiler** before *execution*.
- issue slots: The positions from which instructions cloud(발행하다) issue in a given clock cycle; by analogy, these correspond to positions at the starting blocks for a sprint.
- speculation: An approach whereby the compiler or processor **guesses** the **outcome of an instruction** to **remove** it **as** a dependence in executing other instructions.
- issue packet: The set of instructions that issues together in one clock cycle; the packet may be dtermined statically by the compiler or dynamically by the processor.
- Very Long Instruction Word (VLIW): A style of instruction set architecture that launches many operations that are defined to be independent in a single wide instruction, typically with many separate opcode fields.
- use latency: Number of clock cycles between a load instruction and an instruction that can use the result of the load without stalling th pipeline.
- loop unrolling
- register renaming
- antidependence (=name dependence)
- superscalar
- dynamic pipeline scheduling
- common unit
- reservation station
- reorder buffer
- out-of-order execution
- in-order commit

### 4.16 Concluding Remarks

- instruction latency: The inherent execution time for an instruction.
